\addchap{Appendix}
\label{ch:appendix}



\section{Reference Frames}
\label{sec:frames}

Depending on the application, energies in particle physics are either given as viewed from a suitable rest frame or
independent from the choice of coordinate system altogether. One widely adopted formulation uses the Mandelstam variables
\begin{align*}
	s = (p_1 \kern-0.5pt + p_2)^2 &&
	t = (p_1 \kern-0.5pt - p_3)^2 &&
	u = (p_1 \kern-0.5pt - p_4)^2
\end{align*}
to assign different channels in scattering processes via the squared momentum carried by the exchanged mediating particle.
Implied in this context is the Minkowski inner product, making the above quantities manifestly Lorentz invariant.

When working with parametrizations defined for use in different subdisciplines it often becomes necessary to convert from
center of mass energies $\sqrt{s \kern+1.0pt} \kern+1.0pt$ to the energy $\kern-0.5pt E \kern+1.0pt$ of a projectile in the
target rest frame. With $E^2 = \bm{P}^2 c^2 + M^2 c^4$ as well as momenta $P = (E \kern+1.0pt , \bm{P} \kern+0.75pt c)$ and
$p = (m c^2 \kern-1.0pt , 0)$ one finds
\begin{equation*}
	s = (P + p)^2 = (E + m c^2)^2 - \bm{P}^2 c^2 = 2E m c^2 + \kern+1.0pt m^2 c^4 + M^2 c^4
\end{equation*}
for the invariant mass. This relation is typically approximated as $s = 2E m c^2$ at high energies.



\section{Cross Sections}
\label{sec:cross}



\subsection*{Scattering}

\begin{equation*}
	\sigma_{hp} = H_h \ln^2 \bigl( s \kern+1.0pt / s_h \bigr) + P_h +
	R_h^1 \bigl( s_h \kern+0.5pt / s \bigr)^{\eta_1} + R_h^2 \bigl( s_h \kern+0.5pt / s \bigr)^{\eta_2}
\end{equation*}

\input{content/tables/hadron-scattering.tex}

\begin{equation*}
	\frac{\sigma_{\text{el}\kern+0.5pt} (s)}{\sigma_{\text{tot}\kern+0.5pt} (s)} =
	\mathfrak{A} \tanh (\gamma_1 + \gamma_2 \ln (s) + \gamma_3 \ln^2 (s))
\end{equation*}



\subsection*{Production}

\begin{equation*}
	x_F \kern+1.0pt \frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_F$}} (x_F \kern+0.5pt, \kern-0.5pt E_p)
	= a \kern+0.5pt x_F^b \kern+1.0pt (1 - x_F^m)^n
\end{equation*}

Feynman scaling variable $x_F = p / P$

\cite{Goncalves_2007}

\begin{align*}
	a = a_1 \kern-1.0pt - a_2 \ln\bigl(E_p\bigr) && b = b_1 \kern-1.0pt - b_2 \ln\bigl(E_p\bigr) &&
	n = n_1 \kern-1.0pt - n_2 \ln\bigl(E_p\bigr)
\end{align*}

$m = \num{1.2}$ 

\input{content/tables/charm-production.tex}

As in \cite{Bhattacharya_2015} it is assumed that the cross section scales linearly with the nucleon number, yielding
\begin{equation*}
	\frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_c$}} (x_c \kern+0.5pt, \kern-0.5pt E_p) = A^{-1}
	\frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_F$}} (x_c \kern+0.5pt, \kern-0.5pt E_p)
\end{equation*}
for the inclusive $pp \rightarrow cX$ production.

\qty{75}{\percent} nitrogen and \qty{25}{\percent} oxygen $A = \num{14.5}$

\begin{equation*}
	\frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_h$}} (x_h \kern+0.5pt, \kern-0.5pt E_p) = \int_{\kern+0.5pt x_h}^1 dz \, z^{-1}
	\frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_c$}} (x_c \kern+0.5pt, \kern-0.5pt E_p) \kern+1.0pt D^{\kern+0.5pt h}_c (z)
\end{equation*}



\begin{equation}
	D^{\kern+0.5pt h}_{c}(z) = \frac{N_h z \kern+1.0pt (1 - z)^{\kern+0.5pt 2}}
	{\bigl((1 - z)^{\kern+0.5pt 2} + \epsilon_h z \bigl)^{\raisebox{-1.5ex}{$^2$}}}
	\label{eqn:fragmentation}
\end{equation}



\subsection*{Decay}

\begin{equation*}
	\tilde{F}_{\kern+1.0pt h \kern+1.0pt \rightarrow \kern+1.0pt \nu \kern+1.0pt} (y) = D_h^{-1} \kern+1.0pt \Bigl( 6b_ha_h^2 - 4a_h^3
	- 12\lambda_h^3 a_h + 12\lambda_h^2 y - 6b_h y^2 + 4 y^3 + 12 \lambda_h^2 \ln \bigl((1 - y) / \lambda_h \bigr) \Bigr)
\end{equation*}

\begin{align*}
	a_h = 1 - \lambda_h && b_h = 1 - 2\lambda_h &&
	D_h = 1 - 8 \lambda_h - 12\lambda_h^2 \ln \bigl( \lambda_h \bigr) + 8 \lambda_h^3 - \lambda_h^4
\end{align*}

\input{content/tables/charm-hadrons.tex}



\section{Spectral Distributions}
\label{sec:spectral}



\subsection*{Pions \& Kaons}



\subsection*{Charm}



\section{High Energy Cutoff}
\label{sec:cutoff}



\section{Expansive Magnetic Fields}
\label{sec:fields}



\section{Stochastic Acceleration}
\label{sec:stochastic}

Due to its wide applicability in different astrophysical scenarios, probabilistic collisions are often viewed as one of
the more plausible mechanisms responsible for accelerating cosmic rays to high energies. The general case is described in
\cite{Longair_2011} and supposes that for each collision, particles gain energy proportional to a constant factor $\eta$ and
remain in the region of acceleration with fixed probability $\varsigma$ on average. With initial conditions $N_0$ for the
particle number and $E_0$ as the mean energy, this results in $N \kern+0.9pt = N_0 \varsigma^k$ and $E \kern+0.9pt = E_0 \eta^k$
after $k$ collisions. Using $\ln x^k = k\ln x$ in
\begin{equation*}
	\frac{\ln (N \kern+1.0pt / N_0)}{\ln (E / E_0)} = \frac{\ln(\varsigma)}{\ln(\eta)}
\end{equation*}
eliminates the exponent and by rearranging gives the relation
\begin{equation*}
	N \kern+0.9pt = N_0 \left( \frac{\raisebox{-0.3ex}{$E$}}{\raisebox{0.3ex}{$E_0$}} \right)^{\ln(\varsigma) / \kern-0.5pt \ln(\eta)}
\end{equation*}
connecting energy and number of particles. This integrated spectrum incidentally follows a power law, which is an almost
ubiquitous feature observed in cosmic ray physics. One obtains
\begin{equation*}
	\frac{\raisebox{-0.3ex}{$dN$}}{\raisebox{0.3ex}{$dE$}} = \frac{\raisebox{-0.3ex}{$N_0$}}{\raisebox{0.3ex}{$E_0$}}
	\left( \frac{\raisebox{-0.3ex}{$E$}}{\raisebox{0.3ex}{$E_0$}} \right)^\alpha
\end{equation*}
for the differential spectrum where the spectral index
\begin{equation*}
	\alpha = \frac{\ln(\varsigma)}{\ln(\eta)} - 1
\end{equation*}
is constrained by $\ln(\varsigma) / \kern-0.5pt \ln(\eta) < 0$ due to $\varsigma < 1$ and $\eta > 1$ as implied per the definitions.

The basic case of \abbrev{DSA} considers strong shock fronts moving with velocity $\kern-0.5pt \beta = v / c \kern+1.0pt$ in a
fully ionized gas. Requiring momentum isotropization without significant energy losses on both sides of the discontinuity results
in $\ln(\varsigma) / \kern-0.5pt \ln(\eta) = -1$ for a $dN \kern+0.5pt / dE \propto \kern-0.5pt E^{-2}$ spectral dependence that
is discussed by \cite{Longair_2011} as well. A slightly steeper index $\alpha \approx \num{-2.5}$ can be produced when nonlinear
effects are accounted for to more closely match observations.

Energy gain increasing linearly with $\kern-0.5pt \beta \kern+1.0pt$ leads this mechanism to be categorized as Fermi type acceleration
of first order, whereas the originally proposed formulation scales like $\beta^2$ or as second order. Though shocks exceed the local
speed of sound in the astrophysical medium, relativistic velocities are typically not achieved. Consequently, light speed ratios $\beta \ll 1$ mean
that lower order processes are much more efficient in reaching high particle energies.



\section{Pulsar Spindown}
\label{sec:spindown}



\section{Luminosity Limit}
\label{sec:luminosity}



\section{Implementation}
\label{sec:implementation}

In order to calculate neutrino spectra from hadronic distributions, several integrals have to be computed. Discretizing
this task allows the general case
\begin{align*}
	F(x, y) \kern+1.5pt &= \int_{z_{-}}^{z_{+}} dz \: G(x, z) \, H(z, y) \\
	\intertext{to be rewritten as a Riemann sum. Assuming $G$ and $H$ are integrable over a given interval,}
	F_{ij} \kern+1.8pt &= \sum\nolimits_k D_{kk} \, G_{ik} \, H_{kj}
\end{align*}
converges to the exact solution for sufficiently small steps. Transforming variables
\begin{align*}
	&&&& x \rightarrow x_i && y \rightarrow y_j && z \rightarrow z_k &&&&
\end{align*}
and defining $D_{kk} = z_{k+1} \kern-1.0pt - z_k$ leads to the above notation. It is easily shown how this expression in terms of
indices translates to the product of corresponding matrices
\begin{equation*}
	\bm{F} = \bm{G} \, \bm{D} \, \bm{H}
\end{equation*}
as an equivalent formulation. Here the output $\bm{F} \in \mathbb{R}^{m \times n}$ is obtained from the inputs
$\bm{G} \in \mathbb{R}^{m \times l}$ and $\bm{H} \in \mathbb{R}^{l \times n}$ as well as the square matrix
$\bm{D} \in \mathbb{R}^{l \times l}$ that encodes all step sizes on its diagonal. These results enable a quick and
efficient implementation of the required calculations as program code, where array arithmetic operations can greatly
increase execution speed.\footnote{$\,$In service of reproducability, all implementations can be viewed in
\href{https://github.com/fritzali/bachelor}{this} repository.}
