\addchap{Appendix}
\label{ch:appendix}



\section{Reference Frames}
\label{sec:frames}

Depending on the application, energies in particle physics are either given as viewed from a suitable rest frame or
independent from the choice of coordinate system altogether. One widely adopted formulation uses the Mandelstam variables
\begin{align*}
	s = \bigl( p_1 \kern-0.5pt + p_2 \bigr)^2 &&
	t = \bigl( p_1 \kern-0.5pt - p_3 \bigr)^2 &&
	u = \bigl( p_1 \kern-0.5pt - p_4 \bigr)^2
\end{align*}
to assign different channels in scattering processes via the squared momentum carried by the exchanged mediating particle.
Implied in this context is the Minkowski inner product, making the above quantities manifestly Lorentz invariant.

When working with parametrizations defined for use in different subdisciplines it often becomes necessary to convert from
center of mass energies $\sqrt{s \kern+1.0pt} \kern+1.0pt$ to the energy $\kern-0.5pt E \kern+1.0pt$ of a projectile in the
target rest frame. With $E^2 = \bm{P}^2 c^2 + M^2 c^4$ as well as momenta $P = (E \kern+1.0pt , \bm{P} \kern+0.75pt c)$ and
$p = (m c^2 \kern-1.0pt , 0)$ one finds
\begin{equation*}
	s = (P + p)^2 = (E + m c^2)^2 - \bm{P}^2 c^2 = 2E m c^2 + \kern+1.0pt m^2 c^4 + M^2 c^4
\end{equation*}
for the invariant mass. This relation is typically approximated as $s = 2E m c^2$ at high energies.



\section{Cross Sections}
\label{sec:cross}

By defining an effective area perpendicular to the velocity vectors of projectiles and targets, cross sections measure
the probability of collision processes in particle physics. Due to depending on the strength of an interaction, these
quantities generally scale with energy. Distinct from the integrated case, differential cross sections are usually given
with respect to some independent variable such as angle or momentum of the particle.



\subsection*{Scattering}

To model total cross sections in hadron proton scattering, this work uses the formula
\begin{equation}
	\sigma_{hp} = H_h \ln^2 \bigl( s \kern+1.0pt / s_h \bigr) + P_h +
	R_h^1 \bigl( s_h \kern+0.5pt / s \bigr)^{\eta_1} + R_h^2 \bigl( s_h \kern+0.5pt / s \bigr)^{\eta_2}
	\label{eqn:hpr1r2}
\end{equation}
as given in \cite{Belousov_2016} for a universal analytic parametrization of the corresponding amplitudes.

All adjustable parameters are listed in table~\ref{tab:hadron-scattering} together with relevant meson lifetimes for
cooling. In this approach, the variable $M$ \kern+0.5pt relates to $H \kern+0.5pt = \pi (\hbar c / M)^2$ and
$s_h \kern-0.5pt = (m_h + m_p + M)^2$ as an effective mass. Coefficients in \eqref{eqn:hpr1r2} denote Heisenberg,
Pomeranchuk and Regge terms which have some qualitative motivation, though the formula itself is primarily a quantitative
result.

\input{content/tables/hadron-scattering.tex}

Assuming a quasi universal ratio $\mathscr{R}$ between elastic and total hadron cross sections, one obtains the inelastic
cross section $\sigma_\text{inel} = (1 - \mathscr{R}) \sigma_\text{tot}$ from $\sigma_\text{el} = \mathscr{R} \sigma_\text{tot}$
and $\sigma_\text{el} + \sigma_\text{inel} = \sigma_\text{tot}$ as a unitarity condition. Provided in \cite{Fagundes_2012} is
the model independent parametrization
\begin{equation}
	\mathscr{R}(s) = \frac{\sigma_{\text{el}\kern+0.5pt} (s)}{\sigma_{\text{tot}\kern+0.5pt} (s)} =
	\mathscr{A} \tanh \bigl( \kern+1.0pt \gamma_1 \kern-1.0pt - \gamma_2 \ln (s) + \gamma_3 \ln^2 (s) \bigr)
	\label{eqn:ratio}
\end{equation}
with a constant asymptote $\mathscr{A}$ at very high energies. Coefficients are given in table \ref{tab:hadron-ratio} for
different physical settings. Both equations \eqref{eqn:hpr1r2} and \eqref{eqn:ratio} use units of \unit{\giga\electronvolt\squared}
for the $s$  variables.

\input{content/tables/hadron-ratio.tex}

Reference \cite{Fagundes_2013} tests the asymptotic rise $\sigma(s) \propto \ln^2(s)$ derived in \cite{Froissart_1961} as
a theoretical upper bound and concludes that it is somewhat exceeded. Additionally, a ratio $\mathscr{A} = 1/3$ due to
diffraction as opposed to the black disc limit $\mathscr{A} = 1/2 \kern+0.2pt$ from optical theorem predictions is suggested.
Because parameters are only available in the latter case, all calculations of $\mathscr{R}$ use function \eqref{eqn:ratio}
as defined by an asymptote $\mathscr{A} = 1/2 \kern+0.2pt$ for this work. Data matching $\mathscr{A} = 1/3$ then implies
underestimated values of $\sigma_{\text{inel}\kern+0.5pt}(s)$ which should however not significantly influence the overall results.



\subsection*{Production}

For charm quark production in proton air collisions, reference \cite{Goncalves_2007} gives
\begin{equation*}
	x_F \kern+1.0pt \frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_F$}} \bigl( x_F \kern+0.5pt, \kern-0.5pt E_p \bigr)
	= a \kern+0.5pt x_F^b \kern+1.0pt \bigl( 1 \kern-0.3pt - x_F^m \kern+0.3pt \bigr)^n
\end{equation*}
as the parametrized differential cross section with components
\begin{align*}
	a = a_1 \kern-1.0pt - a_2 \ln\bigl(E_p\bigr) && b = b_1 \kern-1.0pt - b_2 \ln\bigl(E_p\bigr) &&
	n = n_1 \kern-1.0pt - n_2 \ln\bigl(E_p\bigr)
\end{align*}
for which table \ref{tab:charm-production} lists all necessary constants. Here proton energies $E_p$ are defined as viewed
by air nuclei at rest, while the Feynman scaling variable $x_F \kern+1.0pt = p_c \kern+1.5pt / \kern-0.5pt p_s$ specifies
magnitude ratios of produced charm quark longitudinal momentum to all available momentum in center mass coordinates of the
colliding particles. Application of appendix \ref{sec:frames} shows that this approximately fulfills $x_F \kern+1.0pt = x_c$
where $x_c = \kern+0.2pt E_c \kern+1.0pt / E_p$ in the relevant energy ranges.

\input{content/tables/charm-production.tex}

As in \cite{Bhattacharya_2015} it is assumed that the cross section scales linearly with nucleon number, yielding
\begin{equation*}
	\frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_c$}} \bigl( x_c \kern+0.5pt, \kern-0.5pt E_p \bigr) = A^{-1}
	\frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_F$}} \bigl( x_c \kern+0.5pt, \kern-0.5pt E_p \bigr)
\end{equation*}
for inclusive charm production in proton proton collisions. Approximating air as a gas mixture of roughly \qty{75}{\percent}
nitrogen and \qty{25}{\percent} oxygen, one finds $A = \kern-0.3pt \num{14.5}$ for this scaling. Translation of charm quarks
to charmed hadrons is achieved with a folding integral
\begin{equation}
	\frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_h$}}
	\bigl( x_h \kern+0.5pt, \kern-0.5pt E_p \bigr) = \int_{\kern+0.5pt x_h}^1 dz \, z^{-1}
	\frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_c$}}
	\bigl( x_c \kern+0.5pt, \kern-0.5pt E_p \bigr) \kern+1.0pt D^{\kern+0.5pt h}_c (z)
	\label{eqn:differential}
\end{equation}
where $z = E_h \kern+1.0pt / E_c \kern+0.5pt$ and $x_h = E_h \kern+1.0pt / E_p \kern+0.5pt$ as well as
$x_c = x_h \kern+1.0pt / z$ are fractional energies. Limits for the integration follow from a basic inequality
$E_h \leq E_c \kern+0.2pt \leq E_p$ to incorporate kinematic constraints. Furthermore, the probability
of observing any final state $h$ originating from a $c$ quark is encoded in a \emph{Frag$\kern-0.3pt$mentation Function}
(\abbrev{FF}) $D^{\kern+0.5pt h}_c (z)$ dependent on the fraction of hadron to charm energy. Reference
\cite{Metz_2016} addresses the connection between this concept and that of a \emph{Parton Distribution Function}
(\abbrev{PDF}) among other things. 

Where a \abbrev{PDF} represents the probability density of finding a parton with given momentum in a color neutral particle,
probabilities for color neutral states existing inside individual partons are given by the appropriate \abbrev{FF} instead.
The partons described here are either quarks or gluons, which can be free only asymptotically at high energies due to carrying
color charges. In this limit, the running coupling of \abbrev{QCD} is small enough for a power series expansion to be a sensible
approach, leading to the definition of terms such as \abbrev{LO} and \abbrev{NLO} in reference to exponent order. There exist
different factorization methods to separate these parts from the nonperturbative contributions contained in any \abbrev{PDF} and
\abbrev{FF} for the confined constituents of hadrons. By fitting to existing data or perturbative results, models can extrapolate to
low momentum fractions that have not yet been probed experimentally. A similar procedure has lead \cite{Kniehl_2006} to obtain
\begin{equation}
	D^{\kern+0.5pt h}_{c}(z) = \frac{N_h z \kern+1.0pt (1 - z)^{\kern+0.5pt 2}}
	{\bigl((1 - z)^{\kern+0.5pt 2} + \epsilon_h z \bigl)^{\raisebox{-1.5ex}{$^2$}}}
	\label{eqn:fragmentation}
\end{equation}
with parameters from $\kern+0.5pt e^+e^- \kern-0.8pt$ data in table \ref{tab:charm-hadrons} as the charm hadron \abbrev{FF} used
throughout this work. It is important to note that such functions are invariant under charge conjugation, so that there is no
differentiation between quark to particle or antiquark to antiparticle processes.



\section{Spectral Distributions}
\label{sec:spectral}

Constructing spectra $dN_h \kern+0.5pt / dE_h$ from proton injection requires folding of $F_{p \kern+0.8pt \rightarrow h}$ as
the hadronic distribution for a single $p \kern-0.1pt p \kern+0.9pt$ interaction with the number of protons per energy interval
given by the function $dN_p \kern+0.6pt / dE_p$ obtained from source specific modelling. An analogous approach can be applied to
compute neutrino spectra $dN_\nu \kern+0.6pt / dE_\nu$ from $dN_h \kern+0.5pt / dE_h$ via distributions
$F_{\kern+1.0pt h \kern+0.2pt \rightarrow \nu}$ formulated according to the involved decay modes.



\subsection*{Charm}

Spectral distributions for charmed hadron production are calculated according to \cite{Carpio_2020} through
\begin{equation*}
	F_{p \kern+0.8pt \rightarrow h} \bigl( E_h \kern+0.5pt , \kern-0.5pt E_p \bigr) =
	E_p^{\kern+0.5pt -1} \sigma_{p \kern-0.1pt p}^{-1} \bigl( E_p \bigr) \kern+1.0pt
	\frac{\raisebox{-0.5ex}{$d\sigma$}}{\raisebox{0.5ex}{$dx_h$}} \bigl( x_h \kern+0.5pt, \kern-0.5pt E_p \bigr)
\end{equation*}
with $E_h \kern-0.2pt = x_h E_p$ translating between variables. This formula can be understood as a normalization of
\eqref{eqn:differential} against proton energies and the inelastic $p \kern-0.1pt p \kern+0.9pt$ cross section from appendix
\ref{sec:cross} to yield hadron numbers per unit energy.

To find neutrino spectra from charmed hadrons, the same approach as in \cite{Carpio_2020} is used, which assumes an effective
energy distribution approximated by three body decays for the semileptonic channel to a less massive pseudoscalar meson.
By neglecting lepton masses, one obtains
\begin{equation*}
	\tilde{F}_{\kern+1.0pt h \kern+0.2pt \rightarrow \nu \kern+1.0pt} (y) = D_h^{-1} \kern+1.0pt \Bigl( 6b_ha_h^2 - 4a_h^3
	- 12\lambda_h^3 a_h + 12\lambda_h^2 y - 6b_h y^2 + 4 y^3 + 12 \lambda_h^2 \ln \bigl((1 - y) / \lambda_h \bigr) \Bigr)
\end{equation*}
as a distribution with $y = E_\nu \kern+0.6pt / E_h$ and $F_{\kern+1.0pt h \kern+0.2pt \rightarrow \nu \kern+1.0pt}
\bigl( E_\nu \kern+1.0pt , \kern-0.5pt E_h \bigr) = \tilde{F}_{\kern+1.0pt h \kern+0.2pt \rightarrow \nu \kern+1.0pt}
(y) / E_h$ for conversion.

Hadron specific coefficients for this equation are defined with the parameter
$\lambda_h = \kern+0.5pt \tilde{s}_h / m_h^2 \kern+0.2pt$ as
\begin{align*}
	a_h = 1 - \lambda_h && b_h = 1 - 2\lambda_h &&
	D_h = 1 - 8 \lambda_h - 12\lambda_h^2 \ln \bigl( \lambda_h \bigr) + 8 \lambda_h^3 - \lambda_h^4
\end{align*}
where both $s_h$ and $m_h$ are listed in table \ref{tab:charm-hadrons} for all included charmed hadrons. The assumption of three
body decays like $D^+ \kern-2.5pt \rightarrow \kern+1.0pt \overline{\kern-1.5pt K \kern+1.0pt}\kern+1.0pt^0 e^+ \nu_e$ can
be justified by consulting \cite{pdg} for information on the relevant particles and comparing branching ratios, which indicate
that purely leptonic modes are strongly suppressed. Hadronic channels such as $D^+ \kern-2.5pt \rightarrow \pi^+ \pi^0$ or
$D^+ \kern-2.5pt \rightarrow K^{\kern+0.5pt -} \pi^+ \pi^+$ are either very improbable as well or occur at significant rates but
do not contribute many high energy neutrinos due to pions and kaons being subject to further cooling before decaying to leptons.
By the same logic, secondary muon decay is neglected when determining the neutrino spectrum.

\input{content/tables/charm-hadrons.tex}



\subsection*{Pions \& Kaons}

By parametrizing event generator results, a neutral pion production spectrum of the form
\begin{equation*}
	\tilde{F}_\pi \kern+1.5pt \bigl( x_\pi \kern+0.7pt , \kern-0.5pt E_p \bigr) = 4\alpha B x_\pi^{\alpha - 1}
	\left( \frac{1 - \kern+0.2pt x_\pi^\alpha}{1 + \kern+0.8pt rx_\pi^\alpha (1 - \kern+0.2pt x_\pi^\alpha \kern+1.0pt )}
	\right)^{\kern-1.0pt 4} \left( ( 1 - \kern+0.2pt x_\pi^\alpha \kern+1.0pt )^{-1} +
	\frac{r (1 - \kern+0.2pt 2x_\pi^\alpha \kern+1.0pt )}{1 + \kern+0.8pt rx_\pi^\alpha (1 - \kern+0.2pt x_\pi^\alpha \kern+1.0pt )}
	\right) \left( 1 - \kern+0.3pt \frac{m_\pi}{\raisebox{1pt}{$x_\pi \kern+1.0pt E_p$}} \right)^{\kern-1.0pt 1/2}
\end{equation*}
is found in \cite{Kelner_2006} with $m_\pi = \qty{0.135}{\giga\electronvolt}$ \cite{pdg} translated to natural units and parameters
\begin{align*}
	&&&& B \kern+0.5pt = \tilde{B} + C &&
	\alpha \kern+0.5pt = \frac{\raisebox{-1.5pt}{$\tilde{\alpha}$}}{\displaystyle\sqrt{C \kern+1.5pt}} &&
	r \kern+1.0pt = \frac{\raisebox{-1.5pt}{$\tilde{r}$}}{\displaystyle\sqrt{C \kern+1.5pt}} &&&&
\end{align*}
where a low energy cutoff is enforced via $E_\pi \kern-0.1pt = x_\pi \kern+1.0pt E_p$ in the mass term. From
\begin{equation*}
	C = c_1 \kern-0.5pt - \kern+0.5pt c_2 \ln \bigl( E_p \bigr) + \kern+0.5pt  c_3 \ln^2 \bigl( E_p \bigr)
\end{equation*}
results a dependence on projectile energy for the shape of this distribution.\newpage

Coefficients are specified in table \ref{tab:pion-spectrum} and recalculated for $E_p \kern+0.5pt$ in \unit{\giga\electronvolt}
instead of \unit{\tera\electronvolt} units. Under the assumption of a $\smash{\pi^0} \kern-0.5pt$ cross section approximately
equal to the $\smash{\pi^\pm} \kern-0.5pt$ average and with identical spectra for charged pions, it follows that
$F_\pi = \tilde{F}_\pi \kern+0.5pt / E_p$ should describe pion production regardless of charge reasonably well
for the purpose of this work.

\input{content/tables/pion-spectrum.tex}

For a convenient formulation of kaon production, references \cite{Lykasov_2021} and \cite{Lykasov_2022} indicate a constant ratio
$\pi / K$ at moderately high energies. Similar fractions are retrieved from multiplicities given in \cite{Koers_2006} and lead to
$F_K \kern+0.5pt / F_\pi = \num{0.12}$ as a simplifying assumption, the validity of which cannot be guaranteed for the application
at hand. Calculations of kaon spectra still employ this approach but are subject to considerable reservations as a result.

Decays of pions and kaons to neutrinos are approximated via the $h \rightarrow \mu^+ \nu_\mu$ two body channel with branching
fractions of $\mathscr{F}_{\kern-0.2pt \pi \kern+0.2pt} = \qty{99.99}{\percent}$ and
$\mathscr{F}_{\kern+0.3pt K \kern+0.2pt} = \qty{63.56}{\percent}$ given in the \cite{pdg}
particle listings. By decaying, muons produced in these processes can significantly impact the neutrino spectrum. Results from
\cite{Carpio_2020} suggest that this is particularly relevant for pions. Muonic three body decays of type
$\mu^- \kern-2.5pt \kern+0.5pt \rightarrow e^- \kern+0.5pt \overline{\kern-0.2pt \nu \kern+0.8pt}_e \nu_\mu$ as well as
cooling factors depend on the polarization of participating leptons due to the nature of weak force coupling. This complicates
computations and is thus omitted in service of restricting the present work to a managable scope, though it should be remembered
as an important caveat for the final results.

The remaining two body decays of ultrarelativistic hadrons $h$ to leptons $l \kern+1.0pt$ obey a distribution
\begin{equation*}
	F_{\kern+1.0pt h \kern+0.2pt \rightarrow l \kern+1.0pt} \bigl( E_l \kern+0.8pt, \kern-0.2pt E_h \bigr) =
	\mathscr{F}_{\kern+0.2pt h \kern+0.2pt} E_h^{\kern+1.0pt -1} \bigl( 1 \kern-0.3pt - \lambda_h \bigr)^{-1}
\end{equation*}
with $m_{\kern+0.5pt \nu} = 0$ and $m_\mu = \qty{0.106}{\giga\electronvolt}$ \cite{pdg} as well as
$\lambda_h \kern-0.3pt = m_\mu^2 \kern+0.5pt / m_h^2$ as a parameter. This formula is the same whether $l = \nu \kern+0.2pt$ or
$l = \kern-0.3pt \mu$ because there is one muon for each neutrino. In addition, kinematic considerations lead to
$E_\mu \kern+0.5pt / E_h > \lambda_h$ and $E_{\kern+0.5pt \nu} \kern+0.5pt / E_h < 1 - \lambda_h$ for integral bounds
$E_\mu < E_h < E_\mu \kern+0.5pt / \lambda_h$ in the case of muons or
$E_{\kern+0.5pt \nu} \kern+0.5pt / \smash{\bigl( 1 - \lambda_h \bigr)} < E_h < E_p$ when considering neutrinos.



\section{Cooling \& Decay}
\label{sec:cooling}

Consider an infinitesimally thin slice of a target medium with particle number density $n$ and volume $V \kern-0.1pt = S \kern+1.5pt dx$
where $S \kern+0.5pt$ and $dx$ measure surface area and thickness, respectively. Accordingly, there exist $\tilde{N} \kern-1.1pt = nV$
targets that each have effective interaction cross sections $\tilde{\sigma}$ with a total coverage of $\tilde{S} = \tilde{\sigma} \tilde{N}$
as viewed by an incident projectile.

The probability for stopping such a beam constituent then corresponds to the ratio $\mathscr{P} = \tilde{S} / S$ of both areas or
explicitly $\mathscr{P} = \kern-0.5pt \tilde{\sigma} \kern+0.5pt n \kern+1.5pt dx$ in case of $dx$ as the covered distance.
Expressing $\tilde{\sigma} = \kappa\sigma$ in terms of the inelastic scattering cross section $\sigma$ and a dimensionless factor
$\kappa$ called inelasticity, one can identify a length scale $\lambda = (\kappa\sigma n)^{-1}$ as the mean free path between
collisions. Multiplying with $\kappa$ includes the ratio of remaining to initital energy, which is taken to be constant. From this
follows a reduction in beam particles $dN \kern+0.1pt = - N \lambda^{-1} dx$ proportional to $N \kern+1.0pt$ as the total projectile
count and $\mathscr{P} = \kern-0.6pt \lambda^{-1} dx$ for the reformulated probability which represents an ordinary differential equation
of first order. The solution is found to follow an exponential law
\begin{equation*}
	N(x) \kern+0.4pt = N_0 \exp \Bigl( -\frac{\raisebox{-0.5ex}{$x$}}{\raisebox{0.5ex}{$\lambda \kern+0.3pt$}} \kern+0.5pt \Bigr)
\end{equation*}
where $N \kern+1.0pt$ particles remain over some distance $x \kern+0.5pt$ with $N_0$ as the initial amount. Furthermore,
\begin{equation*}
	P(x) \kern+0.3pt = 1 -
	\kern+0.9pt \exp \Bigl( -\frac{\raisebox{-0.5ex}{$x$}}{\raisebox{0.5ex}{$\lambda \kern+0.3pt$}}\kern+0.5pt \Bigr)
\end{equation*}
gives the probability of a particle having been scattered after travelling $x \kern+0.5pt$ length units. Similar steps
for time instead of distance lead to the well known equation
\begin{equation*}
	N(t) \kern+0.4pt = N_0 \exp \kern-2.0pt
	\raisebox{0.25ex}{\(\Bigl( \raisebox{-0.25ex}{\(-\frac{\raisebox{-0.5ex}{$t$}}{\raisebox{1.0ex}{$\tau \kern+1.0pt$}}\)}
	\kern+0.5pt \Bigr)\)}
\end{equation*}
describing exponential decay. It commonly appears in the context of radioactive materials but also applies to hadrons and leptons
or more generally any quantity which decreases at a rate proportional to itself. Analogous to the previous case, a particle
decays with probability
\begin{equation*}
	P(t) \kern+0.3pt = 1 - \kern+0.9pt \exp \kern-2.0pt
	\raisebox{0.25ex}{\(\Bigl( \raisebox{-0.25ex}{\(-\frac{\raisebox{-0.5ex}{$t$}}{\raisebox{1.0ex}{$\tau \kern+1.0pt$}}\)}
	\kern+0.5pt \Bigr)\)}
\end{equation*}
before a time $t$ has passed and for $\tau$ as the mean lifetime. Translating this from rest frame to laboratory coordinates defines
the decay timescale $t_\text{dec} \kern-0.6pt = \tau \kern+0.4pt \varGamma$ with a Lorentz factor $\varGamma = E / m$ via
projectile energy and invariant mass. This is equivalent to a characteristic decay length given by
$\lambda_\text{dec} \kern-0.5pt = v \kern+1.5pt t_\text{dec}$ where the velocity $v = c$ can be set for highly relativistic particles.
Additionally, mean free path and cooling distance $\lambda_\text{cool} = (\kappa\sigma n)^{-1}$ refer to exchangeable concepts. Particles
lose energy in every collision, which is the same as reducing temperature from a thermodynamics perspective. Dividing by the speed of
light $c$ translates this expression to $t_\text{cool} = (\kappa\sigma n \kern+0.5pt c)^{-1}$ as a cooling timescale. Analogously, the
distance $\lambda_\text{dec} \kern-0.5pt = c \kern+0.8pt \tau E / m$ can be rewritten as
$t_\text{dec} \kern-0.6pt = \tau E / m$ in units of time. Substituting into the decay formula yields a cooling factor
\begin{equation}
	\mathscr{C} = 1 - \kern+0.9pt \exp \biggl( -\frac{t_\text{cool}}{\raisebox{0.5ex}{$t_\text{dec}$}} \biggr)
	\label{eqn:cooling}
\end{equation}
which scales spectra from direct production to account for decay processes taking place after collisional energy losses have occured.
This is in some sense a core mechanism for the hypothesis that neutrinos from charm dominate pion and kaon contributions at high
energy regimes. While longer lived particles experience significant cooling due to time dilation, charmed hadron decay is prompt
in comparison. One requirement for the validity of \eqref{eqn:cooling} is that $\lambda_\text{dec} \kern-0.3pt \ll d \kern+0.5pt$
holds with a target field size $d \kern+0.5pt$ to ensure decays occur exclusive inside this region.



\newpage\input{amend/special-head}



\section{High Energy Cutoff}
\label{sec:cutoff}

At very high energies, protons and nuclei interact with cosmic photons, which can be blueshifted up to extreme gamma regimes due to
the Doppler effect. In these processes, the photon spin is absorbed to produce a delta resonance $\Delta^+$ representing an excited
proton state. This decays almost immediately to pairs of nucleons and pions, leading to $p\gamma \rightarrow \kern-0.1pt n\smash{\pi^+}$
or $p\gamma \rightarrow \kern+0.2pt p \smash{\pi^0}$ as probable reaction channels and resulting in a change of momentum for the
produced particles.

For \abbrev{CMB} radiation, a close to perfect black body spectrum has been measured with
\begin{equation*}
	\frac{\raisebox{-0.3ex}{$dn$}}{\raisebox{0.15ex}{$d\epsilon$}} (\epsilon) \kern+0.2pt =
	\frac{\raisebox{-0.3ex}{$\epsilon^2$}}{\pi^2 \hbar^3 c^3 \bigl( e^{\kern+1.0pt \epsilon / k_B T} - 1 \bigr)}
\end{equation*}
given by \cite{Gaisser_2016} as the photon density. This predicts that at a temperature $T \kern-0.5pt = \qty{2.725}{\kelvin}$
significant numbers of photons exist with energies around $\epsilon \kern+0.5pt = \qty{e-12}{\giga\electronvolt}$
in the \abbrev{CMB} rest frame. To find a threshold in center of mass coordinates, the scalar product is used for
\begin{equation*}
	s \kern+0.3pt = \bigl( p_{\kern-0.5pt p} + p_{\kern+0.5pt \gamma} \bigr)^2 =
	p_{\kern-0.5pt p}^2 + p_{\kern+0.5pt \gamma}^2 + 2 p_{\kern-0.5pt p} p_{\kern+0.5pt \gamma} =
	m_p^2 \kern+0.8pt c^4 \kern-0.2pt + 2 E \epsilon = \kern-0.2pt M^2c^4
\end{equation*}
where $M \kern-0.3pt = m_p + \kern+0.3pt m_\pi$ and $m_\gamma = 0$ as well as head on collisions have been assumed. The solution
\begin{equation*}
	E = \Bigl( \kern-1.0pt \bigl( m_p + m_\pi \bigr)^2 c^4 \kern-0.2pt - m_p^2 \kern+0.8pt c^4 \Bigr) / (2\epsilon)
\end{equation*}
or roughly $E \kern+1.0pt = \kern-0.5pt \qty{e+11}{\giga\electronvolt}$ for the so called \abbrev{GZK} cutoff. Energies that exceed
this value when viewed from \abbrev{CMB} coordinates lead to significant losses, making the universe opaque to such protons.
If pair production $\gamma \kern-0.5pt \rightarrow \smash{e^+ \kern-0.5pt e^-}$ via interaction with a proton is considered,
one finds
\begin{equation*}
	E = \Bigl( \kern-1.0pt \bigl( m_p + 2m_e \bigr)^2 c^4 \kern-0.2pt - m_p^2 \kern+0.8pt c^4 \Bigr) / (2\epsilon)
\end{equation*}
approximated to $E \kern+1.0pt = \kern-0.5pt \qty{e+9}{\giga\electronvolt}$ by setting $M \kern-0.3pt = m_p + \kern+0.3pt 2m_e$
instead. For alpha particles and heavier nuclei, similar steps apply, while electrons are limited mainly through Compton
downscattering. Additionally, there exist infrared and radio backgrounds as potentially relevant radiation fields. From
the multiple competing mechanisms for energy losses and momentum isotropization, it is as a consequence extremely challenging
to reliably interpret cosmic ray signals and practically impossible to reconstruct any information about specific sources.



\section{Magnetic Field Scales}
\label{sec:fields}

Particles carrying electric charge $Q = Ze$ and moving at velocity $v \kern+1.0pt$ orthogonal to a homogenous magnetic field $B$ are
acted on by the Lorentz force $F = QvB$ resulting in a gyrating motion. This must then be equal to the relativistic centripetal force
$F = m \varGamma v^2 \kern-0.5pt / R$ on a circular path with $R$ as the Larmor radius. Solving by rearranging and identifying
$p = m \varGamma v \kern+0.5pt$ leads to
\begin{equation*}
	R = \frac{p}{\raisebox{0.3ex}{$QB \kern+0.3pt$}}
\end{equation*}
on which a condition $R < D$ with the magnetic field extent $D$ can be placed.


\newpage\input{amend/normal-head}


In case of highly relativistic energies one can write $E = \kern-0.8pt pc$ to replace momentum and obtain an inequality
$E < QcBD \kern+0.5pt$ from the above considerations. Realistic astrophyiscal magnetic fields are not ordered, following
turbulences travelling through the plasma instead. To incorporate effects of moving scattering centers, a factor
$\kern-0.5pt \beta \kern+0.5pt$ proportional to the AlfvÃ©n velocity is included, giving
\begin{equation}
	E < Ze \kern-0.3pt \beta \kern+0.9pt cBD
	\label{eqn:hillas}
\end{equation}
as the Hillas criterion, named after its description in \cite{Hillas_1984} to constrain source region sizes based on prevailing
magnetic fields for \abbrev{UHECR} acceleration.



\section{Stochastic Acceleration}
\label{sec:stochastic}

Due to its wide applicability in different astrophysical scenarios, probabilistic collisions are often viewed as one of
the more plausible mechanisms responsible for accelerating cosmic rays to high energies. The general case is described in
\cite{Longair_2011} and supposes that for each collision, particles gain energy proportional to a constant factor $\eta$ and
remain in the region of acceleration with fixed probability $\varsigma$ on average. With initial conditions $N_0$ for the
particle number and $E_0$ as the mean energy, this results in $N \kern+0.9pt = N_0 \varsigma^k$ and $E \kern+0.9pt = E_0 \eta^k$
after $k$ collisions. Using $\ln x^k = k\ln x$~in
\begin{equation*}
	\frac{\ln (N \kern+1.0pt / N_0)}{\ln (E / E_0)} = \frac{\ln(\varsigma)}{\ln(\eta)}
\end{equation*}
eliminates the exponent and by rearranging gives the relation
\begin{equation*}
	N \kern+0.9pt = N_0 \left( \frac{\raisebox{-0.3ex}{$E$}}{\raisebox{0.3ex}{$E_0$}} \right)^{\ln(\varsigma) / \kern-0.5pt \ln(\eta)}
\end{equation*}
connecting energy and number of particles. This integrated spectrum incidentally follows a power law, which is an almost
ubiquitous feature observed in cosmic ray physics. One obtains
\begin{equation*}
	\frac{\raisebox{-0.3ex}{$dN$}}{\raisebox{0.3ex}{$dE$}} = \frac{\raisebox{-0.3ex}{$N_0$}}{\raisebox{0.3ex}{$E_0$}}
	\left( \frac{\raisebox{-0.3ex}{$E$}}{\raisebox{0.3ex}{$E_0$}} \right)^\alpha
\end{equation*}
for the differential spectrum where the spectral index
\begin{equation*}
	\alpha = \frac{\ln(\varsigma)}{\ln(\eta)} - 1
\end{equation*}
is constrained by $\ln(\varsigma) / \kern-0.5pt \ln(\eta) < 0$ due to $\varsigma < 1$ and $\eta > 1$ as implied per the definitions.

The basic case of \abbrev{DSA} considers strong shock fronts moving with velocity $\kern-0.5pt \beta = v / c \kern+1.0pt$ in a
fully ionized gas. Requiring momentum isotropization without significant energy losses on both sides of the discontinuity results
in $\ln(\varsigma) / \kern-0.5pt \ln(\eta) = -1$ for a $dN \kern+0.5pt / dE \propto \kern-0.5pt E^{\kern+0.5pt -2}$ spectral dependence
that is discussed by \cite{Longair_2011} as well. A slightly steeper index around $\alpha = \num{-2.5}$ can be derived when nonlinear
effects are accounted for to better reproduce measurements.

Energy gain increasing linearly with $\kern-0.5pt \beta \kern+1.0pt$ leads this mechanism to be categorized as Fermi type acceleration
of first order, whereas the originally proposed formulation scales like $\beta^2$ or as second order. Though shocks exceed the local
speed of sound in the astrophysical medium, relativistic velocities are typically not achieved. Consequently, ratios $\beta \ll 1$ mean
that lower order processes are much more efficient in reaching high particle energies.



\newpage\input{amend/special-head}



\section{Pulsar Spindown}
\label{sec:spindown}



\newpage\input{amend/normal-head}



\section{Accretion Disks}
\label{sec:luminosity}

Diffusely distributed material in orbit around a central massive object naturally produces disk like structures. This is a
consequence of gravitational forces being compensated in the radial plane by rotational effects while matter is relatively
free to collapse in the axial direction. Due to compression and friction during inward spiraling, the disk is heated and
can emit intense thermal radiation. Settings where such phenomena likely occur are protoplanetary disks
surrounding newly formed stars or accretion flows on a \abbrev{SMBH} in the galactic core region, among others.
The following describes some related effects that are for example discussed by \cite{Longair_2011} as well.



\subsection*{Hydrostatic Equilibrium}

In Newtonian physics, the gravitational force at distance $R \kern+0.5pt$ from a mass $M \kern+0.5pt$ is given as
\begin{equation}
	F = \frac{\raisebox{-0.3ex}{$GMm$}}{R^2}
	\label{eqn:newton}
\end{equation}
for particles with masses $m$ orbiting the central object. The resulting acceleration is therefore of magnitude
$g \kern-0.3pt = GM / \smash{R^2}$ with vertical component $\ddot{z} = \kern-0.6pt g \sin(\vartheta)$ with
$\vartheta \kern+0.5pt$ as the elevation angle. In case of $\kern+0.5pt \vartheta \ll \pi / 2$ one can approximate
$\sin(\vartheta) = \kern+0.3pt z / \kern-0.2pt R \kern+0.5pt$ to obtain
\begin{equation*}
	\ddot{z} = \frac{\raisebox{-0.3ex}{$GMz$}}{R^3}
\end{equation*}
which is related to pressure $p \kern+0.5pt$ and density $\kern-0.5pt \rho \kern+0.5pt$ via
$d \kern-0.1pt p / \kern-0.1pt dz = -\rho \ddot{z} \kern+0.5pt$ for a stable equilibrium to exist. Using the speed
of sound $\smash{u^2} \kern-0.7pt = d \kern-0.1pt p / \kern-0.1pt d \kern-0.1pt \rho \kern+0.5pt$ allows reformulation to
\begin{equation*}
	\frac{d \kern-0.1pt \rho}{\raisebox{0.2ex}{$dz \kern+1.0pt$}} =
	-\rho \kern+1.0pt \frac{\raisebox{-0.3ex}{$GMz$}}{u^2R^3}
\end{equation*}
and $\rho \kern+0.6pt = \kern-0.6pt \rho_0 \kern-0.5pt \exp \kern-1.0pt \smash{\bigl( -z^2 \kern-1.8pt / 2 h^2 \bigr)}$
after integration. According to this result, the disk density follows a centered Gaussian distribution with height parameter
$h \kern+0.5pt$ defined via
\begin{equation*}
	h^2 = \frac{\raisebox{-0.3ex}{$u^2R^3$}}{\raisebox{0.2ex}{$GM \kern+1.5pt$}}
\end{equation*}
as the standard deviation. Assuming $M \gg m$ and circular Keplerian orbits, expression \eqref{eqn:newton} equals the
acting centripetal force, leading to $\smash{v^2} \kern-1.0pt = GM / R \kern+0.2pt$ for the orbital velocity. One is then
able to write $\smash{h^2 \kern-0.5pt = u^2R^2 \kern-1.5pt / v^2}$ and from condition $h \ll R$ necessary for the small angle
approximation to be valid follows $u \ll v \kern+1.0pt$ or that orbital velocities must greatly exceed the disk medium specific
speed of sound. This special case is called a thin disk and can further be extended to slim or even thick types of accretion
structures.



\subsection*{Luminosity Limit}

Any luminous object radiating with spherical symmetry excerts a pressure
\begin{equation*}
	P = \frac{\raisebox{-0.3ex}{$L$}}{4\pi R^2 c}
\end{equation*}
as a function of luminosity $L \kern+0.5pt$ at distance $R \kern+0.5pt$ from the source.\newpage

Suppose a gaseous cloud containing particles with masses $m$ falling towards the same bright central mass $M \kern+0.5pt$
due to gravitational attraction. During this process, each particle experiences an opposing radiative force
$F = \kern-0.3pt \varkappa \kern+0.7pt mP \kern+0.5pt$ where the opacity $\kern-0.3pt \varkappa \kern+0.7pt$ measures cross
section per unit mass. Balancing of \eqref{eqn:newton} and rearranging leads to the Eddington limit
\begin{equation}
	L = \frac{\raisebox{-0.3ex}{$4\pi GM c \kern+0.4pt$}}{\raisebox{0.8ex}{$\varkappa$}}
	\label{eqn:eddington}
\end{equation}
on the luminosity beyond which additional matter is immediately blown away from the central object. By assuming that infalling
material consists exclusively of ionized hydrogen, one can approximate $\varkappa \kern-0.1pt = m / \kern-0.5pt \sigma \kern+0.3pt$
with proton mass $m$ and Thomson cross section $\sigma \kern+0.5pt$ from electron scattering. Though originally applied in the
context of stellar structures, this approach can also be used to describe accretion disks. If a compact object increases its mass
with rate $\dot{M} \kern+0.5pt$ due to accreting matter, some of the corresponding gravitational potential may be converted to
radiation. In terms of rest energy, a luminosity $L = \eta\dot{M}c^2$ is obtained where $\eta$ denotes the efficiency of this
mechanism. With \eqref{eqn:eddington} one finds an analogous steady state limit
\begin{equation*}
	\dot{M} \kern-0.2pt = \frac{\raisebox{-0.3ex}{$4\pi GM$}}{\raisebox{0.8ex}{$\eta c \varkappa$}}
\end{equation*}
for the accretion rate, enforced by continuous balancing of radiation pressure and gravitational forces as a natural feedback process.


\section{Particle Theory}
\label{sec:theory}



\newpage\input{amend/normal-head}



\section{Implementation}
\label{sec:implementation}

In order to calculate neutrino spectra from hadronic distributions, several integrals have to be computed. Discretizing
this task allows the general case
\begin{align*}
	F(x, y) \kern+1.5pt &= \int_{z_{-}}^{z_{+}} dz \: G(x, z) \, H(z, y) \\
	\intertext{to be rewritten as a Riemann sum. Assuming $G$ and $H$ are integrable over a given interval,}
	F_{ij} \kern+1.8pt &= \sum\nolimits_k D_{kk} \, G_{ik} \, H_{kj}
\end{align*}
converges to the exact solution for sufficiently small steps. Transforming variables
\begin{align*}
	&&&& x \rightarrow x_i && y \rightarrow y_j && z \rightarrow z_k &&&&
\end{align*}
and defining $D_{kk} = z_{k+1} \kern-1.0pt - z_k$ leads to the above notation. It is easily shown how this expression in terms of
indices translates to the product of corresponding matrices
\begin{equation*}
	\bm{F} \kern+0.6pt = \bm{G} \, \bm{D} \, \bm{H}
\end{equation*}
as an equivalent formulation. Here the output $\bm{F} \in \mathbb{R}^{m \times n}$ is obtained from the inputs
$\bm{G} \in \mathbb{R}^{m \times l}$ and $\bm{H} \in \mathbb{R}^{l \times n}$ as well as the square matrix
$\bm{D} \in \mathbb{R}^{l \times l}$ that encodes all step sizes on its diagonal. These results enable a quick and
efficient implementation of the required calculations as program code, where array arithmetic operations can greatly
increase execution speed.\footnote{$\,$In service of reproducability, all implementations can be viewed in
\href{https://github.com/fritzali/bachelor}{this} repository.}
